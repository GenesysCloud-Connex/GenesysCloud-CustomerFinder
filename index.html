<html>
  <head>
    <script src="//code.jquery.com/jquery-1.11.2.min.js"></script>
    <script>
      // Implicit grant credentials
      const CLIENT_ID = "4eb23f0e-0a17-48dc-ac88-13a44cc82134";

      // Genesys Cloud environment
      const ENVIRONMENT = "cac1.pure.cloud";

      function getParameterByName(name) {
        name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
        var regex = new RegExp("[\\#&]" + name + "=([^&#]*)"),
          results = regex.exec(location.hash);
        return results === null
          ? ""
          : decodeURIComponent(results[1].replace(/\+/g, " "));
      }

      if (window.location.hash) {
        console.log(location.hash);
        var token = getParameterByName("access_token");

        $.ajax({
          url: `https://api.${ENVIRONMENT}/api/v2/users/me`,
          type: "GET",
          beforeSend: function (xhr) {
            xhr.setRequestHeader("Authorization", "bearer " + token);
          },
          success: function (data) {
            console.log(data);
          },
        });

        location.hash = "";
      } else {
        window.location.replace(
          `https://login.cac1.pure.cloud/oauth/authorize?client_id=4eb23f0e-0a17-48dc-ac88-13a44cc82134&response_type=token&redirect_uri=https://genesyscloud-connex.github.io/GenesysCloud_CustomerFinder/`
        );



        // let firstName = '';
        // function findCustomer() {
        //   console.log("HELLO");
        //   externalContactsApi
        //     .getExternalcontactsReversewhitepageslookup(
        //       "dgabriel@connexservice.ca",
        //       null
        //     )
        //     .then((data) => {
        //       firstName = data.contacts[0].firstName;
        //       console.log(firstName);
        //       return firstName;
        //     });
        //   document.getElementById('name').innerHTML = firstName;
        // }
      }
    </script>
  </head>
  <body>
    <form action="" class="form">
      <label for="email">Email Address:</label><br />
      <input
        type="email"
        id="email"
        name="email"
        placeholder="sample@address.com"
      /><br />
      <!-- <button type="submit">Submit</button> -->
      <input type="submit" value="Submit" onclick="" id="btn"/>
    </form>
    <h3 id="greeting">Hello,</h3>
    <h3 id="name"></h3>
  </body>
</html>
